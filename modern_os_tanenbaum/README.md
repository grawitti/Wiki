# Современые операционные систем. 4 изд.
## Конспект

### Эндрю С. Таненбаум  2010 г. изд. Питер 2024 г.

## Отличие операционных систем от других программ

Операционная система (ОС) работает в режиме ядра, в котором возможно выполнение всех комманд которые способен выполнить компьютер. Прикладные програмы работают в пользовательском режиме, в котором доступна ограниченная часть комманд для выполнения.

## Функции ОС

Основное предназначение ОС:

1. Управление аппаратными ресурсами;
2. Предоставление удобного интерфейса и абстракций для прикладных программ (программистов).

### Управление ресурсами

**Мультиплексирование** - распределение ресурсов во времени или пространстве.

*Распределение ресурсов во времени* это когда несколько запущенных программ выполняются на однопроцессорной системе получая управление по очереди.

*Распределение ресурсов в пространстве* - когда каждая из несколько программ занимают выделеную им часть оперативной памяти (ОЗУ).

## Обзор аппаратного обеспечения компьютера

### Процессор

**Центральный процессор** (ЦП) - "мозг" компьютера. Он выбирает комады из памяти и выполняет их.

#### Регистры процессора

Поскольку доступ к памяти для получения команды или данных занимает на много больше времени чем выполнение команд, у всех процессоров есть несколько собственных **регистров** для хранения основных переменных и промежуточных результатов.

**Регистры общего назначения** используются для хранения переменных и промежуточных результатов.

**Регистры специального назначения** используются для хранения только определенных для них специализированных данных.

Регистры специального назначения:

- **Счётчик команд** (СК) - содержит адрес ячейки памяти со следующей выбираемой командой.

- **Указатель стека** (УС) - ссылается на вершину текущего стека в памяти. Стек содержит по одному фрейму для каждой процедуры хранящий её входные параметры, а так же локальные и временные переменные.

- **Регистр слова состояния программы** (PSW Program Status Word) - содержит биты кода условия, устанавливаемые  инструкциями сравнения, биты приоритета выполнения процессором, режима (пользователя или ядра).

**Конвеер** повышает производительность ЦП благодаря выполнению нескольких команд за один такт (цикл работы ЦП). Например по время выполнения команды n, происходит декодирование команды n+1 и выборка команды n+2.
Для каждой из операций в конвеере используется свой блок: блок выборки комад, блок декодирования комад и исполнительный блок.

**Суперскалярный процессор** имеет несколько исполнительных блоков (для разных операций) и несколько блоков выборки и декодирования, а так же буфер обмена.

**Системный вызов** используется для получения услуг от ОС которые выполняются в режиме ядра.

### Память

#### Иерархия памяти

1. Регистры процессора, задержка: <1 нс.
2. Кэш память (L1-L3),  задержка: 2 нс.
3. ОЗУ,                 задержка: 10 мс.
4. Диск, (HDD, SSD)     задержка: 100 мс

### Устройства ввода-вывода

**Устройства ввода-вывода** (УВВ) устройства которые позволяют вводить и выводить информацию в/из компьютера.

УВВ состоят их самого устройства и его контроллера.

ОС взаимодействует с УВВ не напрямую, а через его **контроллер**.

Для взаимодействия с УВВ ОС использует **драйвер устройства**, предоставляемый производителем устройста.

**Драйвер устройства** это специальное, системное программное обеспечение реализующее интерфейс взаимодействия с устройством работающее, в основном, в режиме ядра.

Устройства могут иметь свои регистры, которые могут быть отражены в системную память компьютера или помещаться в специальное адресное пространство **пространство портов ввода-вывода** в котором каждый регистр имеет адрес порта.

Отражение регистров в системную память позволяет не использовать специальные команды для доспупа в регистры, но занимает часть адресного пространства памяти.
Пространство портов ввода-вывода наоборот не занимает память, но требует применения специальных команд для чтения и записи в регистры (IN, OUT).

Способы ввода вывода данных используемые в драйверах устройств:
1. *Активное ожидание* - драйвер постоянно опрашивает устройство дожидаясь завершения последней операции и после этого записывает данные в регистры устройства затем передаёт управление обратно вызываемой программе.
Такой подход загружает процессор опросом устройства об окончании операции.
2. *Прерывания* - драйвер устройства получает прерывание об окончании операции. При этом не требуется постоянно опрашивать устройство.
3. Контроллер **прямого доступа к памяти** (DMA - Direct Memory Access) может управлять передачей данных м/у ОЗУ и некоторыми контроллерами без участия центрального процессора.
Процессор настраивает контроллер DMA для работы с устройством. DMA работает самостоятельно и затем когда завершает работу он выдаёт прерывание.

**Вектор прерывайний** - часть памяти используемая для обработчиков прерываний.

### Зоопарк операционных систем

### Операционные системы мейнфреймов
К высшей категории относятся операционные системы мейнфреймов (больших универсальных машин) — 
компьютеров, занимающих целые залы и до сих пор еще встречающихся в крупных центрах обработки 
корпоративных данных. Операционные системы мейнфреймов ориентированы преимущественно на одновременную 
обработку множества заданий, большинство из которых требует колоссальных объемов ввода-вывода данных. 
Обычно они предлагают три вида обслуживания: пакетную обработку, обработку транзакций и работу в 
режиме разделения времени.
Примером операционной системы универсальных машин может послужить OS/390, наследница OS/360. 
Однако эти операционные системы постепенно вытесняются вариантами операционной системы UNIX, например Linux.

### Серверные операционные системы
Они работают на серверах, которые представлены очень мощными персональными компьютерами, 
рабочими станциями или даже универсальными машинами. Они одновременно обслуживают по сети 
множество пользователей, обеспечивая им общий доступ к аппаратным и программным ресурсам.
Типичными представителями серверных операционных систем являются Solaris, FreeBSD, Linux и 
Windows Server 201x.

### Многопроцессорные операционные системы
Сейчас все шире используется объединение множества центральных процессоров в единую систему, 
что позволяет добиться вычислительной мощности, достойной высшей лиги. В зависимости от того, 
как именно происходит это объединение, а также каковы ресурсы общего пользования, 
эти системы называются параллельными компьютерами, мультикомпьютерами или многопроцессорными системами.
На многопроцессорных системах могут работать многие популярные операционные системы, включая Windows и Linux.

### Операционные системы персональных компьютеров
Задачей операционных систем персональных компьютеров является качественная
поддержка работы отдельного пользователя. Они широко используются для обработки текстов, 
создания электронных таблиц, игр и доступа к Интернету. Типичными примерами могут служить 
операционные системы Linux, FreeBSD, Windows 7, Windows 8 и OS X компании Apple.

### Системы карманных персональных компьютеров
Эти компьютеры, изначально известные как КПК, или PDA (Personal Digital Assistant — 
персональный цифровой секретарь), представляют собой небольшие компьютеры, которые во время 
работы держат в руке. Самыми известными их представителями являются смартфоны и планшеты. 
Как уже говорилось, на этом рынке доминируют операционные системы Android от Google и iOS от Apple, 
но у них имеется множество конкурентов. Большинство таких устройств могут похвастаться 
многоядерными процессорами, GPS, камерами и другими датчиками, достаточным объемом памяти и 
сложными операционными системами.

### Встроенные операционные системы
Встроенные системы работают на компьютерах, которые управляют различными устройствами.
Примерами устройств, где устанавливаются встроенные компьютеры, могут послужить микроволновые печи, 
телевизоры, автомобили, пишущие DVD, обычные телефоны и MP3-плееры.
Наиболее популярными в этой области считаются операционные системы Embedded Linux, QNX и VxWorks.

### Операционные системы сенсорных узлов
Сети, составленные из миниатюрных сенсорных узлов, связанных друг с другом и с базовой станцией 
по беспроводным каналам, развертываются для различных целей. Такие сенсорные сети используются 
для защиты периметров зданий, охраны государственной границы, обнаружения возгораний в лесу, 
измерения температуры и уровня осадков в целях составления прогнозов погоды, сбора информации 
о перемещениях противника на поле боя и многого другого
Примером широко известной операционной системы для сенсорных узлов может послужить TinyOS

### Операционные системы реального времени
Эти системы характеризуются тем, что время для них является ключевым параметром. Например, 
в системах управления производственными процессами компьютеры, работающие в режиме реального времени, 
должны собирать сведения о процессе и использовать их для управления станками на предприятии. 
Довольно часто они должны отвечать очень жестким временным требованиям. Например, 
когда автомобиль перемещается по сборочному конвейеру, то в определенные моменты времени 
должны осуществляться вполне конкретные операции. Если, к примеру, сварочный робот 
приступит к сварке с опережением или опозданием, машина придет в негодность. 
Если операция должна быть проведена точно в срок (или в определенный период времени), 
то мы имеем дело с системой жесткого реального времени. Другой разновидностью подобных 
систем является система мягкого реального времени, в которой хотя и нежелательно, 
но вполне допустимо несоблюдение срока какого-нибудь действия, что не наносит непоправимого вреда. 
К этой категории относятся цифровые аудио- или мультимедийные системы. 
Смартфоны также являются системами мягкого реального времени Примером такой системы может 
послужить eCos. 
Категории операционных систем для КПК, встроенных систем и систем реального времени в значительной степени перекрываются друг с другом по свойственным им признакам. Практически все они имеют по крайней мере некоторые аспекты систем мягкого реального времени.

### Операционные системы смарт-карт
Самые маленькие операционные системы работают на смарт-картах. Смарт-карта представляет
 собой устройство размером с кредитную карту, имеющее собственный процессор. 
 На операционные системы для них накладываются очень жесткие ограничения по 
 требуемой вычислительной мощности процессора и объему памяти.