# Современые операционные систем. 4 изд.
## Конспект

### Эндрю С. Таненбаум  2010 г. изд. Питер 2024 г.

## Отличие операционных систем от других программ

Операционная система (ОС) работает в режиме ядра, в котором возможно выполнение всех комманд которые способен выполнить компьютер. Прикладные програмы работают в пользовательском режиме, в котором доступна ограниченная часть комманд для выполнения.

## Функции ОС

Основное предназначение ОС:

1. Управление аппаратными ресурсами;
2. Предоставление удобного интерфейса и абстракций для прикладных программ (программистов).

### Управление ресурсами

**Мультиплексирование** - распределение ресурсов во времени или пространстве.

*Распределение ресурсов во времени* это когда несколько запущенных программ выполняются на однопроцессорной системе получая управление по очереди.

*Распределение ресурсов в пространстве* - когда каждая из несколько программ занимают выделеную им часть оперативной памяти (ОЗУ).

## Обзор аппаратного обеспечения компьютера

### Процессор

**Центральный процессор** (ЦП) - "мозг" компьютера. Он выбирает комады из памяти и выполняет их.

#### Регистры процессора

Поскольку доступ к памяти для получения команды или данных занимает на много больше времени чем выполнение команд, у всех процессоров есть несколько собственных **регистров** для хранения основных переменных и промежуточных результатов.

**Регистры общего назначения** используются для хранения переменных и промежуточных результатов.

**Регистры специального назначения** используются для хранения только определенных для них специализированных данных.

Регистры специального назначения:

- **Счётчик команд** (СК) - содержит адрес ячейки памяти со следующей выбираемой командой.

- **Указатель стека** (УС) - ссылается на вершину текущего стека в памяти. Стек содержит по одному фрейму для каждой процедуры хранящий её входные параметры, а так же локальные и временные переменные.

- **Регистр слова состояния программы** (PSW Program Status Word) - содержит биты кода условия, устанавливаемые  инструкциями сравнения, биты приоритета выполнения процессором, режима (пользователя или ядра).

**Конвеер** повышает производительность ЦП благодаря выполнению нескольких команд за один такт (цикл работы ЦП). Например по время выполнения команды n, происходит декодирование команды n+1 и выборка команды n+2.
Для каждой из операций в конвеере используется свой блок: блок выборки комад, блок декодирования комад и исполнительный блок.

**Суперскалярный процессор** имеет несколько исполнительных блоков (для разных операций) и несколько блоков выборки и декодирования, а так же буфер обмена.

**Системный вызов** используется для получения услуг от ОС которые выполняются в режиме ядра.

### Память

#### Иерархия памяти

1. Регистры процессора, задержка: <1 нс.
2. Кэш память (L1-L3),  задержка: 2 нс.
3. ОЗУ,                 задержка: 10 мс.
4. Диск, (HDD, SSD)     задержка: 100 мс

### Устройства ввода-вывода

**Устройства ввода-вывода** (УВВ) устройства которые позволяют вводить и выводить информацию в/из компьютера.

УВВ состоят их самого устройства и его контроллера.

ОС взаимодействует с УВВ не напрямую, а через его **контроллер**.

Для взаимодействия с УВВ ОС использует **драйвер устройства**, предоставляемый производителем устройста.

**Драйвер устройства** это специальное, системное программное обеспечение реализующее интерфейс взаимодействия с устройством работающее, в основном, в режиме ядра.

Устройства могут иметь свои регистры, которые могут быть отражены в системную память компьютера или помещаться в специальное адресное пространство **пространство портов ввода-вывода** в котором каждый регистр имеет адрес порта.

Отражение регистров в системную память позволяет не использовать специальные команды для доспупа в регистры, но занимает часть адресного пространства памяти.
Пространство портов ввода-вывода наоборот не занимает память, но требует применения специальных команд для чтения и записи в регистры (IN, OUT).

Способы ввода вывода данных используемые в драйверах устройств:
1. *Активное ожидание* - драйвер постоянно опрашивает устройство дожидаясь завершения последней операции и после этого записывает данные в регистры устройства затем передаёт управление обратно вызываемой программе.
Такой подход загружает процессор опросом устройства об окончании операции.
2. *Прерывания* - драйвер устройства получает прерывание об окончании операции. При этом не требуется постоянно опрашивать устройство.
3. Контроллер **прямого доступа к памяти** (DMA - Direct Memory Access) может управлять передачей данных м/у ОЗУ и некоторыми контроллерами без участия центрального процессора.
Процессор настраивает контроллер DMA для работы с устройством. DMA работает самостоятельно и затем когда завершает работу он выдаёт прерывание.

**Вектор прерывайний** - часть памяти используемая для обработчиков прерываний.

 1.3.6